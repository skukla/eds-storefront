import{n as S,i as l,f,k as g}from"./countries.js";import"@dropins/tools/event-bus.js";class x extends Error{constructor(r){super(r.map(t=>t.message).join(" ")),this.name="FetchError"}}class i extends Error{constructor(r){super(r),this.name="InvalidArgument"}}class $ extends Error{constructor(r){super(r),this.name="UnexpectedError"}}class k extends i{constructor(){super("Cart ID is required")}}class B extends i{constructor(){super("Email is required")}}class F extends i{constructor(){super("Payment method code is required")}}class G extends i{constructor(){super("Billing address is required")}}class Q extends i{constructor(){super("Country Code is required")}}const _=(e,r)=>e.amount.value-r.amount.value,y=e=>!(!e||!e.method_code||!e.method_title||S(e.amount.value)||!e.amount.currency),E=e=>({amount:{value:e.amount.value,currency:e.amount.currency},title:e.method_title,code:e.method_code,carrier:{code:e.carrier_code,title:e.carrier_title},value:`${e.carrier_code} - ${e.method_code}`}),R=e=>{if(y(e))return E(e)},V=e=>{if(e)return e.filter(y).map(r=>E(r)).sort(_)},w=l({pending:!1,data:void 0}),C=l({pending:!1,data:void 0}),q=l({pending:!1,data:void 0}),c=[];function A(e){return new Promise((r,t)=>{c.push(e);const s=()=>{c[0]===e?e().then(r).catch(t).finally(()=>c.shift()):setTimeout(s,100)};s()})}const P=["sender_email","recipient_email"];function T(e){return e.filter(r=>!r.path||!P.some(t=>{var s;return((s=r.path)==null?void 0:s.at(-1))===t}))}const b={cart:w,regions:q,estimateShippingMethods:C};function I(e,r){return r.split(".").reduce((t,s)=>t&&t[s]!==void 0?t[s]:void 0,e)}const v={cart:null,regions:null,estimateShippingMethods:null};async function j(e){const{query:r,options:t,path:s,signalType:u,type:M,transformer:d}=e,n=b[u],p=Symbol();v[u]=p,n.value={...n.value,pending:!0};try{const{data:a,errors:h}=await(M==="mutation"?A(()=>f(r,t).catch(g)):f(r,{method:"GET",cache:"no-cache",...t}).catch(g));if(h){const m=T(h);if(m.length>0)throw new x(m)}let o=I(a,s);if(o===void 0)throw new Error(`No data found at path: ${s}`);return d&&(o=d(o)),n.value={...n.value,data:o},setTimeout(()=>{n.value={...n.value,pending:v[u]===p?!1:n.value.pending}},0),o}catch(a){if(a.name==="AbortError")return;throw n.value={...n.value,pending:!1},a}}export{x as F,i as I,k as M,$ as U,B as a,F as b,G as c,Q as d,w as e,j as f,C as g,R as h,q as r,V as t};
//# sourceMappingURL=dispatchApiCall.js.map
