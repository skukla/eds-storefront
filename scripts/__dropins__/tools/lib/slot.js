import{useRef as S,useState as N,useMemo as y,useContext as R,useCallback as l,useEffect as m}from"../preact-hooks.js";import"../chunks/image-params-keymap.js";import"../preact.js";import{jsx as C}from"../preact-jsx-runtime.js";import{IntlContext as b}from"../i18n.js";function I(o={},p,r){const d=S(null),c=S(!1),a=S([]),[h,f]=N({children:[r==null?void 0:r({})]}),[g,_]=N({}),w=y(()=>({get:t=>g[t],set:(t,e)=>{_({...w,[t]:e})}}),[g]),{intl:P}=R(b);o.dictionary=P.dictionary,o._setProps=f;const i=l(t=>{typeof t=="function"?a.current.push(t):console.warn("Skipped: Invalid _registerMethod",t)},[]);o._registerMethod=i;const u=l(t=>C("div",{"data-slot-html-element":t.tagName.toLowerCase(),ref:e=>{e==null||e.appendChild(t)}}),[]);return o._htmlElementToVNode=u,o.getSlotElement=l(t=>{const e=document.querySelector(`[data-slot-key="${t}"]`);if(e)return{appendChild:s=>{e.appendChild(s)},prependChild:s=>{e.insertBefore(s,e.firstChild)},appendSibling:s=>{const n=e.parentNode;n==null||n.insertBefore(s,e.nextSibling)},prependSibling:s=>{const n=e.parentNode;n==null||n.insertBefore(s,e)}}},[]),o.onChange=l(t=>{a.current.push(t)},[]),o.replaceWith=l(t=>{i(e=>{const s=u(t);e._setProps({children:[s]})})},[u,i]),o.appendChild=l(t=>{i(e=>{const s=u(t);e._setProps(n=>({...n,children:[...n.children,s]}))})},[u,i]),o.prependChild=l(t=>{i(e=>{const s=u(t);e._setProps(n=>({...n,children:[s,...n.children]}))})},[u,i]),o.appendSibling=l(t=>{i(()=>{var s,n;const e=(s=d.current)==null?void 0:s.parentNode;e==null||e.insertBefore(t,((n=d.current)==null?void 0:n.nextSibling)??null)})},[i]),o.prependSibling=l(t=>{i(()=>{var s;const e=(s=d.current)==null?void 0:s.parentNode;e==null||e.insertBefore(t,d.current)})},[i]),m(()=>{const t=d.current;if(!(!p||!t))try{p(o,t)}catch(e){console.error(`Error in "${p.name}" Slot callback`,e)}},[]),m(()=>{f({children:[r==null?void 0:r(h)]}),a.current.forEach(t=>{t(o,w)}),(r==null?void 0:r.name)==="render"&&c.current===!1&&(c.current=!0)},[JSON.stringify(o),JSON.stringify(g),c.current]),[d,h]}function v({name:o,slot:p,context:r,children:d,render:c,...a}){const[h,f]=I(r,p,c??(()=>d));return m(()=>{o||console.warn('Slot "name" is required')},[o]),C("div",{...a,ref:h,"data-slot":o,children:f.children})}window.DROPINS=window.DROPINS||{};window.DROPINS.showSlots=async o=>{window.sessionStorage.setItem("dropin-debugger--show-slots",o.toString()),document.body.classList.toggle("dropin-debugger--show-slots",o)};window.DROPINS.showSlots(window.sessionStorage.getItem("dropin-debugger--show-slots")==="true");export{v as Slot,I as useSlot};
//# sourceMappingURL=slot.js.map
